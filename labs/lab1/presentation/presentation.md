---
## Front matter
lang: ru-RU
title: "Лабораторная работа №1. ЗАЩИТА ДАННЫХ СЕГМЕНТА АСУ ТП"
subtitle: "Дисциплина: Кибербезопасность предприятия"
author:
  - Астраханцева Анастасия
  - Ганина Таисия
  - Ибатулина Дарья
  - Шошина Евгения
  - Кадирова Мехрубон
  - Хассан Факи Абакар

institute:
  - Группа НФИбд-01-22
  - Российский университет дружбы народов, Москва, Россия
date: 30 сентября 2025

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
---

# Вводная часть

## Цели и задачи

Целью лабораторной работы является изучение методов обнаружения, анализа и устранения последствий компьютерных атак в сегменте автоматизированных систем управления технологическим процессом (АСУ ТП) на базе программного комплекса "Ampire". Работа направлена на формирование навыков защиты данных от внешних нарушителей, использующих уязвимости в программном обеспечении, и освоение инструментов мониторинга сетевой безопасности, таких как ViPNet IDS NS, ViPNet TIAS и Security Onion.

## Задание

1. Изучить типовые уязвимости, используемые при атаке на сегмент АСУ ТП.
2. Проанализировать последовательность действий нарушителя на каждом этапе атаки.
3. Освоить методы детектирования атак с использованием средств мониторинга и анализа безопасности.
4. Выполнить мероприятия по устранению последствий атаки.
5. Отработать навыки анализа сетевых соединений и процессов с помощью стандартных утилит.


# Заполнение карточек инцидентов

##

Для обнаружения и анализа атак использовались средства ViPNet IDS NS. Были зафиксированы следующие ключевые инциденты, соответствующие этапам атаки

![Получение доступа через уязвимый Apache Axis 2](image/инцидент1.jpg){#fig:001 width=70%}

##

![AM EXPLOIT Generic Command Injection in HTTP URI](image/инцидент2.jpg){#fig:002 width=70%}

## 

![AM POLICY Apache Axis2 v1.6 Default Admin Credential](image/инцидент3.jpg){#fig:003 width=70%}

##

![ET TROJAN Possible Metasploit Payload Common Construct Bind_API](image/инцидент4.jpg){#fig:004 width=70%}

##

![Уязвимая версия IGSS AM Exploit 7T Interactive Graphical SCADA Buffer Overflow](image/инцидент5.jpg){#fig:005 width=70%}

# Устранение первой уязвимости и последствия (Axis2, App backdoor)

## Процесс аутентификации на целевом хосте

![Процесс аутентификации](image/1.png){#fig:006 width=70%}

## 

:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Для блокировки доступа к конфигурационному файлу axis2.xml и предотвращения эксплуатации уязвимости CVE-2010-0219 в межсетевой экран iptables было добавлено специальное правило

:::
::: {.column width="50%"}

![Добавление правила в iptables для блокировки доступа к axis2.xml](image/2.png){#fig:007 width=70%}

:::
::::::::::::::

## Устранена уязвимость Axis2

![Устранена уязвимость Axis2](image/4.png){#fig:009 width=70%}

##

:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Для полной проверки с помощью утилиты `ss` было выявлено установленное соединение с IP-адресом злоумышленника `195.239.174.11` на порт `7777`, связанное с процессом `evil.conf` (`PID 8367`). Данное соединение является обратным shell-соединением (backdoor), установленным нарушителем, и подлежало немедленному завершению.

:::
::: {.column width="50%"}

![Процесс `evil.conf`](image/5.png){#fig:010 width=70%}

:::
::::::::::::::


##

![Переход к редактированию файла](image/6.png){#fig:011 width=70%}

##

![Редактирование файла /var/spool/cron/crontabs/tomcat](image/7.png){#fig:012 width=70%}

##

![Удалили строку](image/8.png){#fig:013 width=70%}

##

![Удаление вредоносного файла и завершение процесса](image/9.png){#fig:014 width=70%}

##

![Устранена первая уязвимость и её последствие](image/10.png){#fig:015 width=70%}


##

:::::::::::::: {.columns align=center}
::: {.column width="40%"}

Была реализована блокировка сетевого трафика (в Manager Workstation) для уязвимой программы CoolReaderPDF, что является ключевой мерой по предотвращению дальнейшего распространения вредоносного кода и установления обратных соединений с машиной злоумышленника

:::
::: {.column width="60%"}

![Этап создания нового правила брандмауэра](image/13.png){#fig:018 width=70%}

:::
::::::::::::::

##

![Окно настройки создаваемого правила](image/14.png){#fig:019 width=70%}

##

![Проверка в «Мониторе брандмауэра Защитника Windows»](image/15.png){#fig:020 width=70%}

##

:::::::::::::: {.columns align=center}
::: {.column width="40%"}

После открытия командной строки была выполнена команда `netstat -bno`, которая выводит список всех TCP-соединений вместе с именами процессов и их PID. Для устранения угрозы была выполнена команда: `taskkill /f /pid 5348`. Эта команда принудительно (`/f`) завершает процесс с идентификатором 5348.

:::
::: {.column width="60%"}

![taskkill /f /pid 5348](image/18.png){#fig:023 width=70%}

:::
::::::::::::::

##

![Полностью устранена вторая уязвимость и её последствия](image/19.png){#fig:024 width=70%}

##

:::::::::::::: {.columns align=center}
::: {.column width="40%"}

Для проведения работ по защите SCADA-сервера необходимо было получить удалённый доступ к нему. Для этого был использован менеджер паролей KeePass.

:::
::: {.column width="60%"}

![Удаленный доступ к SCADA-сервер](image/20.png){#fig:025 width=70%}

:::
::::::::::::::

##

:::::::::::::: {.columns align=center}
::: {.column width="40%"}


Далее был запущен "Windows security center": в меню "Пуск" - "Accessories" - "System Tools" - "Security center".

:::
::: {.column width="60%"}

!["Пуск" - "Accessories" - "System Tools" - "Security center"](image/21.png){#fig:026 width=70%}

:::
::::::::::::::


##

![Брандмауэр](image/22.png){#fig:027 width=70%}

##

:::::::::::::: {.columns align=center}
::: {.column width="40%"}


На вкладке "Исключения" брандмауэра виден список правил, для которых мы убрали из исключений IGSS Dataserver. Эти правила были использованы злоумышленником для эксплуатации уязвимости.

:::
::: {.column width="60%"}

![Убрали из исключений IGSS Dataserver](image/23.png){#fig:028 width=70%}

:::
::::::::::::::

##

:::::::::::::: {.columns align=center}
::: {.column width="40%"}


Команда netstat -bno (рис. @fig:030) выявила установленное TCP-соединение между SCADA-сервером (10.10.3.10:1163) и IP-адресом злоумышленника (195.239.174.11:28002). Процесс, ответственный за соединение, — IGSSdataServer.exe (PID 2484).

:::
::: {.column width="60%"}

![TCP-соединение](image/25.png){#fig:030 width=70%}

:::
::::::::::::::

## Полностью устранена третья уязвимость и её последствия

![Полностью устранена третья уязвимость и её последствия](image/26.png){#fig:031 width=70%}

# Результаты

В ходе выполнения лабораторной работы был успешно отработан сценарий комплексной кибератаки на сегмент АСУ ТП и проведены мероприятия по её обнаружению и нейтрализации.
